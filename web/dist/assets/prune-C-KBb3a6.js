let i;const w=new Array(128).fill(void 0);w.push(void 0,null,!0,!1);function c(n){return w[n]}let x=w.length;function R(n){n<132||(w[n]=x,x=n)}function u(n){const t=c(n);return R(n),t}const E=typeof TextDecoder<"u"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};typeof TextDecoder<"u"&&E.decode();let v=null;function z(){return(v===null||v.byteLength===0)&&(v=new Uint8Array(i.memory.buffer)),v}function d(n,t){return n=n>>>0,E.decode(z().subarray(n,n+t))}function g(n){x===w.length&&w.push(w.length+1);const t=x;return x=w[t],w[t]=n,t}function h(n){return n==null}let y=null;function o(){return(y===null||y.buffer.detached===!0||y.buffer.detached===void 0&&y.buffer!==i.memory.buffer)&&(y=new DataView(i.memory.buffer)),y}let l=0;const j=typeof TextEncoder<"u"?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},T=typeof j.encodeInto=="function"?function(n,t){return j.encodeInto(n,t)}:function(n,t){const e=j.encode(n);return t.set(e),{read:n.length,written:e.length}};function m(n,t,e){if(e===void 0){const f=j.encode(n),b=t(f.length,1)>>>0;return z().subarray(b,b+f.length).set(f),l=f.length,b}let _=n.length,r=t(_,1)>>>0;const a=z();let s=0;for(;s<_;s++){const f=n.charCodeAt(s);if(f>127)break;a[r+s]=f}if(s!==_){s!==0&&(n=n.slice(s)),r=e(r,_,_=s+n.length*3,1)>>>0;const f=z().subarray(r+s,r+_),b=T(n,f);s+=b.written,r=e(r,_,s,1)>>>0}return l=s,r}function S(n){const t=typeof n;if(t=="number"||t=="boolean"||n==null)return`${n}`;if(t=="string")return`"${n}"`;if(t=="symbol"){const r=n.description;return r==null?"Symbol":`Symbol(${r})`}if(t=="function"){const r=n.name;return typeof r=="string"&&r.length>0?`Function(${r})`:"Function"}if(Array.isArray(n)){const r=n.length;let a="[";r>0&&(a+=S(n[0]));for(let s=1;s<r;s++)a+=", "+S(n[s]);return a+="]",a}const e=/\[object ([^\]]+)\]/.exec(toString.call(n));let _;if(e.length>1)_=e[1];else return toString.call(n);if(_=="Object")try{return"Object("+JSON.stringify(n)+")"}catch{return"Object"}return n instanceof Error?`${n.name}: ${n.message}
${n.stack}`:_}let k=null;function D(){return(k===null||k.byteLength===0)&&(k=new Float64Array(i.memory.buffer)),k}function F(n,t){return n=n>>>0,D().subarray(n/8,n/8+t)}let A=null;function L(){return(A===null||A.byteLength===0)&&(A=new Float32Array(i.memory.buffer)),A}function $(n,t){return n=n>>>0,L().subarray(n/4,n/4+t)}function B(n,t){n=n>>>0;const e=o(),_=[];for(let r=n;r<n+4*t;r+=4)_.push(u(e.getUint32(r,!0)));return _}function I(n,t){try{return n.apply(this,t)}catch(e){i.__wbindgen_exn_store(g(e))}}const W=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(n=>i.__wbg_api_free(n>>>0,1));class N{__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,W.unregister(this),t}free(){const t=this.__destroy_into_raw();i.__wbg_api_free(t,0)}constructor(){const t=i.api_new();return this.__wbg_ptr=t>>>0,W.register(this,this.__wbg_ptr,this),this}set_on_complex_change(t){i.api_set_on_complex_change(this.__wbg_ptr,g(t))}set_on_grid_change(t){i.api_set_on_grid_change(this.__wbg_ptr,g(t))}set_on_vineyards_change(t){i.api_set_on_vineyards_change(this.__wbg_ptr,g(t))}set_on_pruned_change(t){i.api_set_on_pruned_change(this.__wbg_ptr,g(t))}load_complex(t){try{const r=i.__wbindgen_add_to_stack_pointer(-16),a=m(t,i.__wbindgen_malloc,i.__wbindgen_realloc),s=l;i.api_load_complex(r,this.__wbg_ptr,a,s);var e=o().getInt32(r+4*0,!0),_=o().getInt32(r+4*1,!0);if(_)throw u(e)}finally{i.__wbindgen_add_to_stack_pointer(16)}}get complex(){try{const r=i.__wbindgen_add_to_stack_pointer(-16);i.api_complex(r,this.__wbg_ptr);var t=o().getInt32(r+4*0,!0),e=o().getInt32(r+4*1,!0),_=o().getInt32(r+4*2,!0);if(_)throw u(e);return u(t)}finally{i.__wbindgen_add_to_stack_pointer(16)}}load_mesh_grid(t){try{const r=i.__wbindgen_add_to_stack_pointer(-16),a=m(t,i.__wbindgen_malloc,i.__wbindgen_realloc),s=l;i.api_load_mesh_grid(r,this.__wbg_ptr,a,s);var e=o().getInt32(r+4*0,!0),_=o().getInt32(r+4*1,!0);if(_)throw u(e)}finally{i.__wbindgen_add_to_stack_pointer(16)}}get grid(){try{const r=i.__wbindgen_add_to_stack_pointer(-16);i.api_grid(r,this.__wbg_ptr);var t=o().getInt32(r+4*0,!0),e=o().getInt32(r+4*1,!0),_=o().getInt32(r+4*2,!0);if(_)throw u(e);return u(t)}finally{i.__wbindgen_add_to_stack_pointer(16)}}set grid(t){try{const r=i.__wbindgen_add_to_stack_pointer(-16);i.api_set_grid(r,this.__wbg_ptr,g(t));var e=o().getInt32(r+4*0,!0),_=o().getInt32(r+4*1,!0);if(_)throw u(e)}finally{i.__wbindgen_add_to_stack_pointer(16)}}lifetimes_for_simplices(t){try{const a=i.__wbindgen_add_to_stack_pointer(-16);i.api_lifetimes_for_simplices(a,this.__wbg_ptr,g(t));var e=o().getInt32(a+4*0,!0),_=o().getInt32(a+4*1,!0),r=o().getInt32(a+4*2,!0);if(r)throw u(_);return u(e)}finally{i.__wbindgen_add_to_stack_pointer(16)}}vertex_positions(){try{const s=i.__wbindgen_add_to_stack_pointer(-16);i.api_vertex_positions(s,this.__wbg_ptr);var t=o().getInt32(s+4*0,!0),e=o().getInt32(s+4*1,!0),_=o().getInt32(s+4*2,!0),r=o().getInt32(s+4*3,!0);if(r)throw u(_);var a=F(t,e).slice();return i.__wbindgen_free(t,e*8,8),a}finally{i.__wbindgen_add_to_stack_pointer(16)}}edge_positions(){try{const s=i.__wbindgen_add_to_stack_pointer(-16);i.api_edge_positions(s,this.__wbg_ptr);var t=o().getInt32(s+4*0,!0),e=o().getInt32(s+4*1,!0),_=o().getInt32(s+4*2,!0),r=o().getInt32(s+4*3,!0);if(r)throw u(_);var a=F(t,e).slice();return i.__wbindgen_free(t,e*8,8),a}finally{i.__wbindgen_add_to_stack_pointer(16)}}face_positions(){try{const s=i.__wbindgen_add_to_stack_pointer(-16);i.api_face_positions(s,this.__wbg_ptr);var t=o().getInt32(s+4*0,!0),e=o().getInt32(s+4*1,!0),_=o().getInt32(s+4*2,!0),r=o().getInt32(s+4*3,!0);if(r)throw u(_);var a=F(t,e).slice();return i.__wbindgen_free(t,e*8,8),a}finally{i.__wbindgen_add_to_stack_pointer(16)}}medial_axes_face_positions(t){try{const f=i.__wbindgen_add_to_stack_pointer(-16);i.api_medial_axes_face_positions(f,this.__wbg_ptr,t);var e=o().getInt32(f+4*0,!0),_=o().getInt32(f+4*1,!0),r=o().getInt32(f+4*2,!0),a=o().getInt32(f+4*3,!0);if(a)throw u(r);var s=$(e,_).slice();return i.__wbindgen_free(e,_*4,4),s}finally{i.__wbindgen_add_to_stack_pointer(16)}}swaplist_from_face_index(t,e){try{const s=i.__wbindgen_add_to_stack_pointer(-16);i.api_swaplist_from_face_index(s,this.__wbg_ptr,t,e);var _=o().getInt32(s+4*0,!0),r=o().getInt32(s+4*1,!0),a=o().getInt32(s+4*2,!0);if(a)throw u(r);return u(_)}finally{i.__wbindgen_add_to_stack_pointer(16)}}subproblems(){try{const s=i.__wbindgen_add_to_stack_pointer(-16);i.api_subproblems(s,this.__wbg_ptr);var t=o().getInt32(s+4*0,!0),e=o().getInt32(s+4*1,!0),_=o().getInt32(s+4*2,!0),r=o().getInt32(s+4*3,!0);if(r)throw u(_);var a=B(t,e).slice();return i.__wbindgen_free(t,e*4,4),a}finally{i.__wbindgen_add_to_stack_pointer(16)}}serialize_core(){try{const r=i.__wbindgen_add_to_stack_pointer(-16);i.api_serialize_core(r,this.__wbg_ptr);var t=o().getInt32(r+4*0,!0),e=o().getInt32(r+4*1,!0),_=o().getInt32(r+4*2,!0);if(_)throw u(e);return u(t)}finally{i.__wbindgen_add_to_stack_pointer(16)}}deserialize_core(t){try{const r=i.__wbindgen_add_to_stack_pointer(-16);i.api_deserialize_core(r,this.__wbg_ptr,g(t));var e=o().getInt32(r+4*0,!0),_=o().getInt32(r+4*1,!0);if(_)throw u(e)}finally{i.__wbindgen_add_to_stack_pointer(16)}}serialize_vineyards(){try{const r=i.__wbindgen_add_to_stack_pointer(-16);i.api_serialize_vineyards(r,this.__wbg_ptr);var t=o().getInt32(r+4*0,!0),e=o().getInt32(r+4*1,!0),_=o().getInt32(r+4*2,!0);if(_)throw u(e);return u(t)}finally{i.__wbindgen_add_to_stack_pointer(16)}}deserialize_vineyards(t){try{const r=i.__wbindgen_add_to_stack_pointer(-16);i.api_deserialize_vineyards(r,this.__wbg_ptr,g(t));var e=o().getInt32(r+4*0,!0),_=o().getInt32(r+4*1,!0);if(_)throw u(e)}finally{i.__wbindgen_add_to_stack_pointer(16)}}deserialize_vineyards_load(t){try{const r=i.__wbindgen_add_to_stack_pointer(-16);i.api_deserialize_vineyards_load(r,this.__wbg_ptr,g(t));var e=o().getInt32(r+4*0,!0),_=o().getInt32(r+4*1,!0);if(_)throw u(e)}finally{i.__wbindgen_add_to_stack_pointer(16)}}serialize_pruned_swaps(t){try{const a=i.__wbindgen_add_to_stack_pointer(-16);i.api_serialize_pruned_swaps(a,this.__wbg_ptr,t);var e=o().getInt32(a+4*0,!0),_=o().getInt32(a+4*1,!0),r=o().getInt32(a+4*2,!0);if(r)throw u(_);return u(e)}finally{i.__wbindgen_add_to_stack_pointer(16)}}deserialize_pruned_swaps(t,e){try{const a=i.__wbindgen_add_to_stack_pointer(-16);i.api_deserialize_pruned_swaps(a,this.__wbg_ptr,t,g(e));var _=o().getInt32(a+4*0,!0),r=o().getInt32(a+4*1,!0);if(r)throw u(_)}finally{i.__wbindgen_add_to_stack_pointer(16)}}deserialize_from_cli(t){try{const r=i.__wbindgen_add_to_stack_pointer(-16);i.api_deserialize_from_cli(r,this.__wbg_ptr,g(t));var e=o().getInt32(r+4*0,!0),_=o().getInt32(r+4*1,!0);if(_)throw u(e)}finally{i.__wbindgen_add_to_stack_pointer(16)}}run_vineyards(t){try{const a=i.__wbindgen_add_to_stack_pointer(-16);i.api_run_vineyards(a,this.__wbg_ptr,h(t)?0:g(t));var e=o().getInt32(a+4*0,!0),_=o().getInt32(a+4*1,!0),r=o().getInt32(a+4*2,!0);if(r)throw u(_);return u(e)}finally{i.__wbindgen_add_to_stack_pointer(16)}}prune(t,e,_){try{const s=i.__wbindgen_add_to_stack_pointer(-16);i.api_prune(s,this.__wbg_ptr,t,g(e),h(_)?0:g(_));var r=o().getInt32(s+4*0,!0),a=o().getInt32(s+4*1,!0);if(a)throw u(r)}finally{i.__wbindgen_add_to_stack_pointer(16)}}has_vineyards(){return i.api_has_vineyards(this.__wbg_ptr)!==0}barcode_for_index(t){try{const a=i.__wbindgen_add_to_stack_pointer(-16);i.api_barcode_for_index(a,this.__wbg_ptr,g(t));var e=o().getInt32(a+4*0,!0),_=o().getInt32(a+4*1,!0),r=o().getInt32(a+4*2,!0);if(r)throw u(_);return u(e)}finally{i.__wbindgen_add_to_stack_pointer(16)}}}async function V(n,t){if(typeof Response=="function"&&n instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(n,t)}catch(_){if(n.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve Wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",_);else throw _}const e=await n.arrayBuffer();return await WebAssembly.instantiate(e,t)}else{const e=await WebAssembly.instantiate(n,t);return e instanceof WebAssembly.Instance?{instance:e,module:n}:e}}function q(){const n={};return n.wbg={},n.wbg.__wbindgen_object_drop_ref=function(t){u(t)},n.wbg.__wbindgen_string_new=function(t,e){const _=d(t,e);return g(_)},n.wbg.__wbindgen_number_new=function(t){return g(t)},n.wbg.__wbindgen_error_new=function(t,e){const _=new Error(d(t,e));return g(_)},n.wbg.__wbindgen_number_get=function(t,e){const _=c(e),r=typeof _=="number"?_:void 0;o().setFloat64(t+8*1,h(r)?0:r,!0),o().setInt32(t+4*0,!h(r),!0)},n.wbg.__wbindgen_is_bigint=function(t){return typeof c(t)=="bigint"},n.wbg.__wbindgen_bigint_from_i64=function(t){return g(t)},n.wbg.__wbindgen_jsval_eq=function(t,e){return c(t)===c(e)},n.wbg.__wbindgen_boolean_get=function(t){const e=c(t);return typeof e=="boolean"?e?1:0:2},n.wbg.__wbindgen_string_get=function(t,e){const _=c(e),r=typeof _=="string"?_:void 0;var a=h(r)?0:m(r,i.__wbindgen_malloc,i.__wbindgen_realloc),s=l;o().setInt32(t+4*1,s,!0),o().setInt32(t+4*0,a,!0)},n.wbg.__wbindgen_is_object=function(t){const e=c(t);return typeof e=="object"&&e!==null},n.wbg.__wbindgen_is_undefined=function(t){return c(t)===void 0},n.wbg.__wbindgen_in=function(t,e){return c(t)in c(e)},n.wbg.__wbindgen_as_number=function(t){return+c(t)},n.wbg.__wbindgen_object_clone_ref=function(t){const e=c(t);return g(e)},n.wbg.__wbindgen_is_string=function(t){return typeof c(t)=="string"},n.wbg.__wbindgen_jsval_loose_eq=function(t,e){return c(t)==c(e)},n.wbg.__wbg_String_b9412f8799faab3e=function(t,e){const _=String(c(e)),r=m(_,i.__wbindgen_malloc,i.__wbindgen_realloc),a=l;o().setInt32(t+4*1,a,!0),o().setInt32(t+4*0,r,!0)},n.wbg.__wbindgen_bigint_from_u64=function(t){const e=BigInt.asUintN(64,t);return g(e)},n.wbg.__wbg_getwithrefkey_edc2c8960f0f1191=function(t,e){const _=c(t)[c(e)];return g(_)},n.wbg.__wbg_set_f975102236d3c502=function(t,e,_){c(t)[u(e)]=u(_)},n.wbg.__wbg_get_5419cf6b954aa11d=function(t,e){const _=c(t)[e>>>0];return g(_)},n.wbg.__wbg_length_f217bbbf7e8e4df4=function(t){return c(t).length},n.wbg.__wbg_new_034f913e7636e987=function(){const t=new Array;return g(t)},n.wbg.__wbindgen_is_function=function(t){return typeof c(t)=="function"},n.wbg.__wbg_new_7a87a0376e40533b=function(){return g(new Map)},n.wbg.__wbg_next_13b477da1eaa3897=function(t){const e=c(t).next;return g(e)},n.wbg.__wbg_next_b06e115d1b01e10b=function(){return I(function(t){const e=c(t).next();return g(e)},arguments)},n.wbg.__wbg_done_983b5ffcaec8c583=function(t){return c(t).done},n.wbg.__wbg_value_2ab8a198c834c26a=function(t){const e=c(t).value;return g(e)},n.wbg.__wbg_iterator_695d699a44d6234c=function(){return g(Symbol.iterator)},n.wbg.__wbg_get_ef828680c64da212=function(){return I(function(t,e){const _=Reflect.get(c(t),c(e));return g(_)},arguments)},n.wbg.__wbg_call_a9ef466721e824f2=function(){return I(function(t,e){const _=c(t).call(c(e));return g(_)},arguments)},n.wbg.__wbg_new_e69b5f66fda8f13c=function(){const t=new Object;return g(t)},n.wbg.__wbg_set_425e70f7c64ac962=function(t,e,_){c(t)[e>>>0]=u(_)},n.wbg.__wbg_from_91a67a5f04c98a54=function(t){const e=Array.from(c(t));return g(e)},n.wbg.__wbg_isArray_6f3b47f09adb61b5=function(t){return Array.isArray(c(t))},n.wbg.__wbg_instanceof_ArrayBuffer_74945570b4a62ec7=function(t){let e;try{e=c(t)instanceof ArrayBuffer}catch{e=!1}return e},n.wbg.__wbg_call_8547f4f9ec48f360=function(){return I(function(t,e,_,r,a){const s=c(t).call(c(e),c(_),c(r),c(a));return g(s)},arguments)},n.wbg.__wbg_set_277a63e77c89279f=function(t,e,_){const r=c(t).set(c(e),c(_));return g(r)},n.wbg.__wbg_isSafeInteger_b9dff570f01a9100=function(t){return Number.isSafeInteger(c(t))},n.wbg.__wbg_buffer_ccaed51a635d8a2d=function(t){const e=c(t).buffer;return g(e)},n.wbg.__wbg_newwithbyteoffsetandlength_7e3eb787208af730=function(t,e,_){const r=new Uint8Array(c(t),e>>>0,_>>>0);return g(r)},n.wbg.__wbg_new_fec2611eb9180f95=function(t){const e=new Uint8Array(c(t));return g(e)},n.wbg.__wbg_set_ec2fcf81bc573fd9=function(t,e,_){c(t).set(c(e),_>>>0)},n.wbg.__wbg_length_9254c4bd3b9f23c4=function(t){return c(t).length},n.wbg.__wbg_instanceof_Uint8Array_df0761410414ef36=function(t){let e;try{e=c(t)instanceof Uint8Array}catch{e=!1}return e},n.wbg.__wbg_log_c9486ca5d8e2cbe8=function(t,e){let _,r;try{_=t,r=e,console.log(d(t,e))}finally{i.__wbindgen_free(_,r,1)}},n.wbg.__wbg_log_aba5996d9bde071f=function(t,e,_,r,a,s,f,b){let M,O;try{M=t,O=e,console.log(d(t,e),d(_,r),d(a,s),d(f,b))}finally{i.__wbindgen_free(M,O,1)}},n.wbg.__wbg_mark_40e050a77cc39fea=function(t,e){performance.mark(d(t,e))},n.wbg.__wbg_measure_aa7a73f17813f708=function(){return I(function(t,e,_,r){let a,s,f,b;try{a=t,s=e,f=_,b=r,performance.measure(d(t,e),d(_,r))}finally{i.__wbindgen_free(a,s,1),i.__wbindgen_free(f,b,1)}},arguments)},n.wbg.__wbg_new_abda76e883ba8a5f=function(){const t=new Error;return g(t)},n.wbg.__wbg_stack_658279fe44541cf6=function(t,e){const _=c(e).stack,r=m(_,i.__wbindgen_malloc,i.__wbindgen_realloc),a=l;o().setInt32(t+4*1,a,!0),o().setInt32(t+4*0,r,!0)},n.wbg.__wbg_error_f851667af71bcfc6=function(t,e){let _,r;try{_=t,r=e,console.error(d(t,e))}finally{i.__wbindgen_free(_,r,1)}},n.wbg.__wbindgen_bigint_get_as_i64=function(t,e){const _=c(e),r=typeof _=="bigint"?_:void 0;o().setBigInt64(t+8*1,h(r)?BigInt(0):r,!0),o().setInt32(t+4*0,!h(r),!0)},n.wbg.__wbindgen_debug_string=function(t,e){const _=S(c(e)),r=m(_,i.__wbindgen_malloc,i.__wbindgen_realloc),a=l;o().setInt32(t+4*1,a,!0),o().setInt32(t+4*0,r,!0)},n.wbg.__wbindgen_throw=function(t,e){throw new Error(d(t,e))},n.wbg.__wbindgen_memory=function(){const t=i.memory;return g(t)},n}function C(n,t){return i=n.exports,U.__wbindgen_wasm_module=t,y=null,A=null,k=null,v=null,i.__wbindgen_start(),i}async function U(n){if(i!==void 0)return i;typeof n<"u"&&(Object.getPrototypeOf(n)===Object.prototype?{module_or_path:n}=n:console.warn("using deprecated parameters for the initialization function; pass a single object instead")),typeof n>"u"&&(n=new URL("/ma/assets/mars_wasm_bg-UGJjbf4W.wasm",import.meta.url));const t=q();(typeof n=="string"||typeof Request=="function"&&n instanceof Request||typeof URL=="function"&&n instanceof URL)&&(n=fetch(n));const{instance:e,module:_}=await V(await n,t);return C(e,_)}function p(n,t,e){postMessage({type:"progress",data:{label:n,i:t,n:e}})}onmessage=async n=>{const{core:t,vineyards:e,dim:_,params:r}=n.data;await U(),p("Read input",0,1);const a=new N;p("Deserialize input",0,6),a.deserialize_core(t),p("Deserialize input",1,6),a.deserialize_vineyards(e),p("Deserialize input",2,6),p("Pruning",3,6),a.prune(_,r,p),p("Serialize output",99,100);const s=a.serialize_pruned_swaps(_);postMessage({type:"result",data:s})};onmessageerror=n=>{console.error(n),postMessage(`got message error: ${n.data}`)};
